<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Handy Anleitungen</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
            background: #f5f5f5;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            overflow: hidden;
            -webkit-text-size-adjust: 100%;
            touch-action: manipulation;
        }

        .container {
            width: 100%;
            max-width: 600px;
            height: 100vh;
            background: #ffffff;
            border-radius: 0;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: none;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .home-button {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            background: #f0f0f0;
            border: 1px solid #d0d0d0;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .home-button:hover {
            background: #e0e0e0;
            border-color: #c0c0c0;
        }

        .home-button svg {
            width: 28px;
            height: 28px;
            fill: #333333;
        }

        .title {
            text-align: center;
            color: #333333;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            margin-top: 20px;
            padding: 0 80px;
            text-transform: uppercase;
            letter-spacing: 3px;
            line-height: 1.3;
        }

        .category-grid {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 30px;
            overflow-y: auto;
            flex: 1;
            padding-right: 10px;
        }
        
        .category-grid::-webkit-scrollbar {
            width: 8px;
        }
        
        .category-grid::-webkit-scrollbar-track {
            background: #f5f5f5;
            border-radius: 4px;
        }
        
        .category-grid::-webkit-scrollbar-thumb {
            background: #d0d0d0;
            border-radius: 4px;
        }
        
        .category-grid::-webkit-scrollbar-thumb:hover {
            background: #b0b0b0;
        }

        .category-button,
        .handout-button {
            background: #f0f0f0;
            border: 1px solid #d0d0d0;
            border-radius: 16px;
            padding: 28px 24px;
            font-size: 18px;
            font-weight: 700;
            color: #333333;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .category-button:hover,
        .handout-button:hover {
            background: #e0e0e0;
            border-color: #c0c0c0;
        }

        .viewer-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            margin-top: 70px;
            flex: 1;
            overflow: hidden;
            justify-content: flex-start;
            min-height: 0;
        }

        .image-viewer {
            width: 100%;
            background: #f8f8f8;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
            overflow: hidden;
            position: relative;
            max-height: calc(100vh - 200px);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 1;
        }
        
        .image-viewer::-webkit-scrollbar {
            display: none;
        }
        
        .image-viewer {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .image-viewer img {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            display: block;
            cursor: zoom-in;
            object-fit: contain;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }

        .image-viewer.zoomed {
            overflow: auto;
        }

        .image-viewer.zoomed img {
            cursor: zoom-out;
            transform: scale(2);
            transform-origin: top left;
        }

        .error-message {
            padding: 20px;
            text-align: center;
            color: #ff6b6b;
            font-weight: 600;
            line-height: 1.8;
        }

        .navigation {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-top: 15px;
            flex-shrink: 0;
        }

        .nav-button {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border: 1px solid #d0d0d0;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }

        .nav-button:hover:not(:disabled) {
            background: #e0e0e0;
            border-color: #c0c0c0;
        }

        .nav-button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-button svg {
            width: 24px;
            height: 24px;
            fill: #333333;
        }

        .page-indicator {
            background: #f0f0f0;
            border: 1px solid #d0d0d0;
            padding: 12px 24px;
            border-radius: 24px;
            font-weight: 600;
            color: #333333;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            font-size: 16px;
        }

        .zoom-hint {
            text-align: center;
            color: #666666;
            font-size: 14px;
            margin-top: 10px;
            font-style: italic;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #333333;
            font-weight: 600;
        }

        @media (max-width: 640px) {
            body {
                padding: 0;
            }
            
            .container {
                padding: 10px 10px;
                max-width: 100%;
            }

            .title {
                font-size: 18px;
                padding: 0 60px;
                letter-spacing: 1px;
                margin-bottom: 15px;
                margin-top: 15px;
            }

            .category-button,
            .handout-button {
                font-size: 15px;
                padding: 20px 16px;
                letter-spacing: 1px;
                border-radius: 12px;
            }
            
            .category-grid {
                gap: 12px;
                margin-top: 20px;
                padding-right: 5px;
            }
            
            .home-button {
                width: 44px;
                height: 44px;
                top: 15px;
                left: 15px;
                border-radius: 10px;
            }
            
            .home-button svg {
                width: 22px;
                height: 22px;
            }
            
            .viewer-container {
                gap: 10px;
                margin-top: 55px;
            }
            
            .image-viewer {
                border-radius: 8px;
                max-height: calc(100vh - 160px);
            }
            
            .navigation {
                gap: 10px;
                margin-top: 10px;
                width: 100%;
                justify-content: center;
                flex-shrink: 0;
            }
            
            .nav-button {
                width: 50px;
                height: 50px;
                border-radius: 10px;
            }
            
            .nav-button svg {
                width: 20px;
                height: 20px;
            }
            
            .page-indicator {
                padding: 10px 20px;
                font-size: 14px;
                border-radius: 20px;
                flex: 1;
                max-width: 160px;
                text-align: center;
            }
            
            .error-message {
                padding: 15px;
                font-size: 14px;
            }
            
            .loading {
                padding: 15px;
                font-size: 15px;
            }
        }
        
        /* Sehr kleine Displays (unter 380px) */
        @media (max-width: 380px) {
            .title {
                font-size: 16px;
                padding: 0 55px;
            }
            
            .category-button,
            .handout-button {
                font-size: 14px;
                padding: 18px 14px;
            }
            
            .page-indicator {
                font-size: 13px;
                padding: 8px 16px;
            }
            
            .image-viewer {
                max-height: calc(100vh - 150px);
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState } = React;

        /* 
         * ═══════════════════════════════════════════════════════════════
         * ORDNERSTRUKTUR FÜR BILDER
         * ═══════════════════════════════════════════════════════════════
         * 
         * Erstellen Sie einen Ordner "bilder" neben der HTML-Datei:
         * 
         * meine-website/
         * ├── handout-viewer.html (diese Datei)
         * └── bilder/
         *     ├── medizinische-apps_e-rezept_1.jpg
         *     ├── medizinische-apps_e-rezept_2.jpg
         *     ├── medizinische-apps_gesundheitskarte_1.jpg
         *     └── ...
         * 
         * Benennungsschema: kategorie-id_handout-id_seitennummer.jpg
         * 
         * ═══════════════════════════════════════════════════════════════
         */

        const categoriesConfig = {
            'medizinische-apps': {
                title: 'MEDIZINISCHE APPS',
                handouts: [
                    { id: 'e-rezept', title: 'E-REZEPT APP NUTZEN' },
                    { id: 'doctolib', title: 'DOCTOLIB' }
                ]
            },
            'oeffentliche-verkehrsmittel': {
                title: 'ÖFFENTLICHE VERKEHRSMITTEL',
                handouts: [
                    { id: 'fahrplan', title: 'FAHRPLAN APP' },
                    { id: 'ticket', title: 'TICKET KAUFEN' }
                ]
            },
            'online-banking': {
                title: 'ONLINE BANKING',
                handouts: [
                    { id: 'banking-app', title: 'BANKING APP EINRICHTEN' },
                    { id: 'ueberweisung', title: 'ÜBERWEISUNG DURCHFÜHREN' }
                ]
            },
            'allgemeine-nutzung': {
                title: 'ALLGEMEINE NUTZUNG',
                handouts: [
                    { id: 'grundfunktionen', title: 'GRUNDFUNKTIONEN' },
                    { id: 'einstellungen', title: 'EINSTELLUNGEN' }
                ]
            }
        };

        const HomeIcon = () => (
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
        );

        const ArrowLeft = () => (
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
            </svg>
        );

        const ArrowRight = () => (
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
            </svg>
        );

        function App() {
            const [view, setView] = useState('categories');
            const [selectedCategory, setSelectedCategory] = useState(null);
            const [selectedHandout, setSelectedHandout] = useState(null);
            const [currentPage, setCurrentPage] = useState(0);
            const [isZoomed, setIsZoomed] = useState(false);
            const [availablePages, setAvailablePages] = useState([]);
            const [imageError, setImageError] = useState(false);
            const [isLoading, setIsLoading] = useState(false);

            const goHome = () => {
                setView('categories');
                setSelectedCategory(null);
                setSelectedHandout(null);
                setCurrentPage(0);
                setIsZoomed(false);
                setAvailablePages([]);
            };

            const selectCategory = (categoryId) => {
                setSelectedCategory(categoryId);
                setView('handouts');
            };

            const selectHandout = async (handout, categoryId) => {
                setIsLoading(true);
                setSelectedHandout({ ...handout, categoryId });
                setCurrentPage(0);
                setView('viewer');
                setIsZoomed(false);
                
                const pages = await loadAvailablePages(categoryId, handout.id);
                setAvailablePages(pages);
                setIsLoading(false);
            };

            const loadAvailablePages = async (categoryId, handoutId) => {
                const extensions = ['jpg', 'jpeg', 'png'];
                const foundPages = [];
                
                // Versuche Seiten von 1 bis 20 zu finden
                for (let i = 1; i <= 20; i++) {
                    let pageFound = false;
                    
                    for (let ext of extensions) {
                        const filename = `bilder/${categoryId}_${handoutId}_${i}.${ext}`;
                        
                        try {
                            const exists = await checkImageExists(filename);
                            if (exists) {
                                foundPages.push(filename);
                                pageFound = true;
                                break;
                            }
                        } catch (e) {
                            // Bild nicht gefunden, weiter versuchen
                        }
                    }
                    
                    // Wenn keine Seite gefunden, abbrechen
                    if (!pageFound) {
                        break;
                    }
                }
                
                return foundPages;
            };

            const checkImageExists = (url) => {
                return new Promise((resolve) => {
                    const img = new Image();
                    const timeout = setTimeout(() => {
                        img.src = '';
                        resolve(false);
                    }, 3000);
                    
                    img.onload = () => {
                        clearTimeout(timeout);
                        resolve(true);
                    };
                    img.onerror = () => {
                        clearTimeout(timeout);
                        resolve(false);
                    };
                    img.src = url;
                });
            };

            const nextPage = () => {
                if (currentPage < availablePages.length - 1) {
                    setCurrentPage(currentPage + 1);
                    setIsZoomed(false);
                    setImageError(false);
                }
            };

            const prevPage = () => {
                if (currentPage > 0) {
                    setCurrentPage(currentPage - 1);
                    setIsZoomed(false);
                    setImageError(false);
                }
            };

            const toggleZoom = () => {
                if (!imageError) {
                    setIsZoomed(!isZoomed);
                }
            };

            const handleImageError = () => {
                setImageError(true);
            };

            const handleImageLoad = () => {
                setImageError(false);
            };

            return (
                <>
                    {view !== 'categories' && (
                        <button className="home-button" onClick={goHome}>
                            <HomeIcon />
                        </button>
                    )}

                    {view === 'categories' && (
                        <>
                            <h1 className="title">Kategorien</h1>
                            <div className="category-grid">
                                {Object.keys(categoriesConfig).map(categoryId => (
                                    <button
                                        key={categoryId}
                                        className="category-button"
                                        onClick={() => selectCategory(categoryId)}
                                    >
                                        {categoriesConfig[categoryId].title}
                                    </button>
                                ))}
                            </div>
                        </>
                    )}

                    {view === 'handouts' && selectedCategory && (
                        <>
                            <h1 className="title">{categoriesConfig[selectedCategory].title}</h1>
                            <div className="category-grid">
                                {categoriesConfig[selectedCategory].handouts.map((handout, index) => (
                                    <button
                                        key={index}
                                        className="handout-button"
                                        onClick={() => selectHandout(handout, selectedCategory)}
                                    >
                                        {handout.title}
                                    </button>
                                ))}
                            </div>
                        </>
                    )}

                    {view === 'viewer' && selectedHandout && (
                        <div className="viewer-container">
                            {isLoading ? (
                                <div className="loading">Lade Bilder...</div>
                            ) : availablePages.length === 0 ? (
                                <div className="error-message">
                                    ❌ Keine Bilder gefunden<br/><br/>
                                    Erwarteter Pfad:<br/>
                                    <strong style={{color: '#333333', fontSize: '14px', display: 'inline-block', marginTop: '10px', padding: '8px 16px', background: '#f0f0f0', borderRadius: '8px', border: '1px solid #d0d0d0'}}>
                                        bilder/{selectedHandout.categoryId}_{selectedHandout.id}_1.jpg
                                    </strong>
                                    <br/><br/>
                                    <span style={{fontSize: '14px', color: '#666'}}>
                                        Erstellen Sie einen Ordner "bilder" neben der HTML-Datei<br/>
                                        und legen Sie dort Ihre Bilder ab.
                                    </span>
                                </div>
                            ) : (
                                <>
                                    <div className={`image-viewer ${isZoomed ? 'zoomed' : ''}`}>
                                        {imageError ? (
                                            <div className="error-message">
                                                Bild konnte nicht geladen werden
                                            </div>
                                        ) : (
                                            <img
                                                src={availablePages[currentPage]}
                                                alt={`Schritt ${currentPage + 1}`}
                                                onClick={toggleZoom}
                                                onError={handleImageError}
                                                onLoad={handleImageLoad}
                                            />
                                        )}
                                    </div>
                                    <div className="navigation">
                                        <button
                                            className="nav-button"
                                            onClick={prevPage}
                                            disabled={currentPage === 0}
                                        >
                                            <ArrowLeft />
                                        </button>
                                        <div className="page-indicator">
                                            Schritt {currentPage + 1} von {availablePages.length}
                                        </div>
                                        <button
                                            className="nav-button"
                                            onClick={nextPage}
                                            disabled={currentPage === availablePages.length - 1}
                                        >
                                            <ArrowRight />
                                        </button>
                                    </div>
                                </>
                            )}
                        </div>
                    )}
                </>
            );
        }

        ReactDOM.render(<App />, document.getElementById('app'));
    </script>
</body>
</html>
